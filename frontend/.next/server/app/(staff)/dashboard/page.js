(()=>{var e={};e.id=995,e.ids=[995],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},8359:()=>{},3739:()=>{},441:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(9191),s(7195),s(5866),s(8337);var r=s(3191),a=s(8716),n=s(7922),l=s.n(n),o=s(5231),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let d=["",{children:["(staff)",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,9191)),"/home/hirwa/Desktop/PROJECTS/E-garage/frontend/app/(staff)/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,7195)),"/home/hirwa/Desktop/PROJECTS/E-garage/frontend/app/(staff)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,8337)),"/home/hirwa/Desktop/PROJECTS/E-garage/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/hirwa/Desktop/PROJECTS/E-garage/frontend/app/(staff)/dashboard/page.tsx"],x="/(staff)/dashboard/page",u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(staff)/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8949:(e,t,s)=>{Promise.resolve().then(s.bind(s,5607))},9990:(e,t,s)=>{Promise.resolve().then(s.bind(s,9941)),Promise.resolve().then(s.bind(s,381))},760:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},5607:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(326),a=s(7577),n=s(6824),l=s(68),o=s(8196);function i(){let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(!0),[d,c]=(0,a.useState)();async function x(e){try{i(!0),c(void 0);let{data:s}=await n.Z.get("/clients?status=pending",{signal:e});t(Array.isArray(s)?s.slice(0,4):[])}catch(t){if(e?.aborted)return;c(t?.response?.data?.message||"Failed to load pending jobs")}finally{e?.aborted||i(!1)}}let u=()=>x();return(0,r.jsxs)("div",{className:"grid grid-cols-1 gap-6 xl:grid-cols-3",children:[(0,r.jsxs)("div",{className:"xl:col-span-2 space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"text-sm text-slate-400",children:"Pending jobs"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:u,className:"rounded-md border border-white/10 bg-slate-900 px-3 py-1.5 text-xs text-slate-300 hover:bg-slate-800",children:"Refresh"}),r.jsx("a",{href:"/jobs?status=pending",className:"text-xs text-brand-400 hover:underline",children:"View all"})]})]}),d&&(0,r.jsxs)("div",{className:"rounded-lg border border-red-500/30 bg-red-500/10 p-3 text-sm text-red-300",children:[d,r.jsx("button",{onClick:u,className:"ml-3 rounded-md border border-red-500/30 px-2 py-0.5 text-xs hover:bg-red-500/10",children:"Retry"})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2","aria-live":"polite",children:[s&&!d&&Array.from({length:4}).map((e,t)=>(0,r.jsxs)("div",{className:"card h-[180px] animate-pulse space-y-3",children:[r.jsx("div",{className:"h-5 w-40 rounded bg-slate-700/40"}),r.jsx("div",{className:"h-4 w-56 rounded bg-slate-700/30"}),r.jsx("div",{className:"h-4 w-28 rounded bg-slate-700/20"}),r.jsx("div",{className:"h-8 w-32 rounded bg-slate-700/20"})]},t)),!s&&!d&&e.length>0&&e.map(e=>r.jsx(o.Z,{job:e},e._id)),!s&&!d&&0===e.length&&(0,r.jsxs)("div",{className:"col-span-full grid place-items-center rounded-xl border border-white/10 bg-white/5 py-12 text-center text-slate-400",children:[r.jsx("div",{className:"text-sm",children:"No pending jobs."}),r.jsx("div",{className:"mt-1 text-xs text-slate-500",children:"Create a job to see it here."})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[r.jsx("div",{className:"text-sm text-slate-400",children:"Team chat"}),r.jsx("div",{className:"card p-0",children:r.jsx("div",{className:"h-[560px]",children:r.jsx(l.default,{room:"ops:dashboard"})})})]})]})}},68:(e,t,s)=>{"use strict";s.d(t,{default:()=>c});var r=s(326),a=s(7577),n=s(57);let l="http://localhost:5000";l||console.error("❌ Missing NEXT_PUBLIC_API_URL for socket");let o=(0,n.io)(l||"/",{autoConnect:!1});s(6824);var i=s(8737),d=s(1135);function c({room:e}){let[t,s]=(0,a.useState)([]),[n,l]=(0,a.useState)(""),[c,x]=(0,a.useState)(!0),[u,p]=(0,a.useState)(),[m,h]=(0,a.useState)(o.connected),[g,b]=(0,a.useState)(null),f=(0,a.useRef)(null),v=(0,a.useRef)(null);(0,a.useRef)(!0),(0,a.useRef)(null);let j=(0,a.useRef)(0);(0,a.useRef)(new Set);let w="guest";function y(){let t=n.trim();if(!t||!m)return;let r="tmp-"+Date.now(),a={_id:r,room:e,sender:w,text:t,at:new Date().toISOString(),pending:!0};s(e=>[a,...e]),l(""),v.current?.focus(),o.emit("chat:message",{room:e,sender:w,text:t},e=>{e?.ok||s(e=>e.map(e=>e._id===r?{...e,pending:!1,error:"Failed to send"}:e))})}return(0,r.jsxs)("div",{className:"flex h-full flex-col rounded-2xl border border-slate-800 bg-slate-900/60",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-800 px-4 py-2 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-slate-300",children:[r.jsx("span",{className:(0,d.Z)("h-2 w-2 rounded-full",m?"bg-emerald-400":"bg-slate-500")}),(0,r.jsxs)("span",{children:["Room: ",e]}),g&&(0,r.jsxs)("span",{className:"ml-2 text-xs text-slate-400",children:[g," is typing…"]})]}),u&&r.jsx("button",{onClick:()=>{x(!0),p(void 0)},className:"text-xs text-amber-300 hover:underline",children:"Retry load"})]}),(0,r.jsxs)("div",{ref:f,className:"flex-1 space-y-2 overflow-y-auto px-4 py-3",children:[c&&r.jsx("div",{className:"text-sm text-slate-500",children:"Loading messages…"}),!c&&u&&r.jsx("div",{className:"rounded-md border border-amber-500/30 bg-amber-500/10 p-2 text-xs text-amber-200",children:u}),!c&&!u&&t.slice().reverse().map(e=>{let t=e.sender===w,s=e.at||e.createdAt;return r.jsx("div",{className:(0,d.Z)("flex",t?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:(0,d.Z)("max-w-[75%] rounded-2xl px-3 py-2 text-sm shadow",t?"rounded-br-sm bg-brand-600 text-white":"rounded-bl-sm bg-slate-800 text-slate-100"),children:[r.jsx("div",{className:"mb-0.5 text-[11px] opacity-80",children:e.sender}),r.jsx("div",{children:e.text}),(0,r.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-[10px] opacity-70",children:[s&&r.jsx("span",{children:(0,i.WU)(s)}),e.pending&&r.jsx("span",{children:"Sending…"}),e.error&&r.jsx("span",{className:"text-rose-300",children:e.error})]})]})},e._id||e.sender+e.text+(s||""))})]}),(0,r.jsxs)("div",{className:"flex gap-2 border-t border-slate-800 p-3",children:[r.jsx("input",{ref:v,value:n,onChange:function(t){l(t.target.value);let s=Date.now();m&&s-j.current>900&&(j.current=s,o.emit("chat:typing",{room:e,sender:w}))},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y())},placeholder:m?"Type a message…":"Connecting…",className:"flex-1 rounded-xl bg-slate-800 px-3 py-2 outline-none disabled:opacity-60",disabled:!m}),r.jsx("button",{onClick:y,className:(0,d.Z)("rounded-xl px-4",m?"bg-brand-600 hover:bg-brand-700":"bg-slate-700/60 cursor-not-allowed"),disabled:!m,children:"Send"})]})]})}},3303:(e,t,s)=>{"use strict";s.d(t,{O:()=>d,_:()=>c});var r=s(326);let a=(...e)=>e.filter(Boolean).join(" "),n=e=>String(e||"").trim().toLowerCase(),l=e=>String(e||"").replace(/[-_]/g," ").replace(/\b\w/g,e=>e.toUpperCase()),o={sm:"text-[10px] px-2 py-0.5",md:"text-xs px-2.5 py-1",lg:"text-sm px-3 py-1.5"};function i({className:e=""}){return r.jsx("span",{className:a("h-1.5 w-1.5 rounded-full",e)})}function d({value:e,size:t="md",className:s=""}){let d=n(e),c={pending:{bg:"bg-amber-500/15",text:"text-amber-300",dot:"bg-amber-400",icon:(0,r.jsxs)("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("circle",{cx:"12",cy:"12",r:"9"}),r.jsx("path",{d:"M12 7v5l3 3"})]})},repairing:{bg:"bg-sky-500/15",text:"text-sky-300",dot:"bg-sky-400",icon:(0,r.jsxs)("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M3 21l3-3 6-6"}),r.jsx("path",{d:"M14 7l-1 1 3 3 1-1a3 3 0 10-3-3z"})]})},completed:{bg:"bg-emerald-500/15",text:"text-emerald-300",dot:"bg-emerald-400",icon:r.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})}}[d]||{bg:"bg-slate-700/40",text:"text-slate-300",dot:"bg-slate-400"},x=l(e||"Unknown");return(0,r.jsxs)("span",{role:"status",title:`Status: ${x}`,"data-kind":"status","data-value":d||"unknown",className:a("inline-flex items-center gap-1.5 rounded-md ring-1 ring-white/10",c.bg,c.text,o[t],s),children:[r.jsx(i,{className:c.dot}),c.icon,r.jsx("span",{children:x})]})}function c({value:e,size:t="md",className:s=""}){let d=n(e),c={unpaid:{bg:"bg-rose-500/15",text:"text-rose-300",dot:"bg-rose-400",icon:(0,r.jsxs)("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M6 6l12 12"}),r.jsx("path",{d:"M12 3v18"})]})},paid:{bg:"bg-emerald-500/15",text:"text-emerald-300",dot:"bg-emerald-400",icon:r.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:r.jsx("path",{d:"M20 6L9 17l-5-5"})})}}[d]||{bg:"bg-slate-700/40",text:"text-slate-300",dot:"bg-slate-400"},x=l(e||"Unknown");return(0,r.jsxs)("span",{role:"status",title:`Payment: ${x}`,"data-kind":"payment","data-value":d||"unknown",className:a("inline-flex items-center gap-1.5 rounded-md ring-1 ring-white/10",c.bg,c.text,o[t],s),children:[r.jsx(i,{className:c.dot}),c.icon,r.jsx("span",{children:x})]})}},8196:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var r=s(326),a=s(434),n=s(3303);function l({job:e,hrefBase:t="/jobs"}){let s=(e?.names||"Unknown Client").toString(),l=[e?.carMake,e?.carType].filter(Boolean).join(" • "),i=e?.plateNumber||"—",d=e?.issues||"-",c=e?._id?String(e._id):"",x="http://localhost:5000",u=c&&x?`${x}/clients/${c}/pdf`:"#",p=c?`${t}/${c}`:"#",m=!c;return(0,r.jsxs)("article",{className:"group card relative min-h-[180px] overflow-hidden p-5 md:p-6 transition hover:-translate-y-0.5 hover:border-brand-500/40 focus-within:border-brand-500/60","data-status":e?.status,"data-payment":e?.payment,children:[r.jsx("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-brand-500/40 via-sky-400/30 to-emerald-400/30"}),(0,r.jsxs)("div",{className:"mb-3 grid grid-cols-[auto_1fr] items-center gap-x-3 gap-y-2 md:mb-4",children:[r.jsx(o,{name:s,className:"row-span-2"}),r.jsx("div",{className:"min-w-0 leading-tight col-start-2",children:r.jsx("span",{className:"block max-w-full text-base font-semibold md:text-lg line-clamp-2 md:line-clamp-1 md:truncate",title:s,children:s})}),(0,r.jsxs)("div",{className:"col-start-2 flex flex-wrap gap-2",children:[r.jsx(n.O,{value:e?.status}),r.jsx(n._,{value:e?.payment})]})]}),(0,r.jsxs)("div",{className:"min-w-0 text-base text-slate-200",children:[r.jsx("span",{className:"truncate",children:l||"Vehicle —"})," ","•"," ",r.jsx("span",{className:"text-slate-400",title:"Plate number",children:i})]}),r.jsx("p",{className:"mt-2 line-clamp-3 text-sm text-slate-300",title:String(d),children:d}),(0,r.jsxs)("div",{className:"mt-4 flex flex-wrap gap-3 md:gap-4",children:[(0,r.jsxs)(a.default,{href:p,className:`inline-flex items-center gap-1.5 rounded-lg px-4 py-2 text-base transition focus:outline-none focus:ring-2 focus:ring-brand-500/40 ${m?"bg-slate-700/60 cursor-not-allowed":"bg-brand-600 hover:bg-brand-700"}`,"aria-disabled":m,tabIndex:m?-1:0,children:[(0,r.jsxs)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M5 12h14"}),r.jsx("path",{d:"M12 5l7 7-7 7"})]}),"Open"]}),(0,r.jsxs)("a",{href:u,className:"inline-flex items-center gap-1.5 rounded-lg bg-slate-800 px-4 py-2 text-base transition hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-brand-500/40",target:"_blank",rel:"noreferrer noopener","aria-disabled":!c||!x,onClick:e=>{c&&x||e.preventDefault()},children:[(0,r.jsxs)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[r.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),r.jsx("path",{d:"M14 2v6h6"}),r.jsx("path",{d:"M12 18v-6"}),r.jsx("path",{d:"M9 15h6"})]}),"Export PDF"]})]}),r.jsx("div",{className:"pointer-events-none absolute -inset-1 opacity-0 transition-opacity duration-500 group-hover:opacity-100","aria-hidden":!0,children:r.jsx("div",{className:"absolute -top-24 left-0 h-24 w-full bg-gradient-to-r from-white/5 to-transparent blur-xl"})})]})}function o({name:e,className:t}){let s=e.split(/\s+/).filter(Boolean).slice(0,2).map(e=>e[0]?.toUpperCase()).join("")||"?";return r.jsx("div",{className:`grid h-12 w-12 place-items-center rounded-full bg-brand-500/15 text-brand-400 ring-1 ring-white/10 ${t||""}`,children:r.jsx("span",{className:"text-base font-semibold",children:s})})}},6824:(e,t,s)=>{"use strict";s.d(t,{Z:()=>l});var r=s(4099);let a="http://localhost:5000";a||console.error("❌ Missing NEXT_PUBLIC_API_URL in .env.local");let n=r.Z.create({baseURL:a||"/"});n.interceptors.request.use(e=>e);let l=n},9941:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>c,a:()=>x});var r=s(326),a=s(7577),n=s(6824),l=s(381),o=s(8201);let i=(0,a.createContext)(null);function d(e){return["admin","staff","client"].includes(e)?e:(console.warn(`Invalid role "${e}" received; defaulting to "client"`),"client")}function c({children:e}){let[t,s]=(0,a.useState)(null),[c,x]=(0,a.useState)(!0);async function u(e,t){try{let{data:r}=await n.Z.post("/auth/login",{email:e,password:t});if(!r?.token)throw Error("Invalid API response: missing token");let a=(0,o.o)(r.token);if(!a.email||!a.role)throw Error("Invalid token payload: missing email or role");let i=d(a.role),c=a.verified??!0;r.role&&r.role!==a.role&&console.warn(`API role "${r.role}" does not match token role "${a.role}"`),localStorage.setItem("token",r.token);let x={email:a.email,role:i,verified:c};localStorage.setItem("user",JSON.stringify(x)),s(x),c||l.ZP.error("Please verify your email first.")}catch(e){console.error("Login error:",e),l.ZP.error("Invalid credentials")}}async function p(e,t){try{let{data:r}=await n.Z.post("/auth/register",{email:e,password:t});if(!r?.token)throw Error("Invalid API response: missing token");let a=(0,o.o)(r.token);if(!a.email||!a.role)throw Error("Invalid token payload: missing email or role");let i=d(a.role),c=a.verified??!0;r.role&&r.role!==a.role&&console.warn(`API role "${r.role}" does not match token role "${a.role}"`),localStorage.setItem("token",r.token);let x={email:a.email,role:i,verified:c};localStorage.setItem("user",JSON.stringify(x)),s(x),l.ZP.success("Account created.")}catch(e){console.error("Signup error:",e),l.ZP.error("Signup failed")}}return r.jsx(i.Provider,{value:{user:t,loading:c,login:u,signup:p,logout:function(){localStorage.clear(),s(null),window.location.href="/"}},children:e})}function x(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth outside provider");return e}},9191:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>o});var r=s(8570);let a=(0,r.createProxy)(String.raw`/home/hirwa/Desktop/PROJECTS/E-garage/frontend/app/(staff)/dashboard/page.tsx`),{__esModule:n,$$typeof:l}=a;a.default;let o=(0,r.createProxy)(String.raw`/home/hirwa/Desktop/PROJECTS/E-garage/frontend/app/(staff)/dashboard/page.tsx#default`)},8337:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x,metadata:()=>c});var r=s(9510);s(7272);var a=s(8570);let n=(0,a.createProxy)(String.raw`/home/hirwa/Desktop/PROJECTS/E-garage/frontend/lib/auth.tsx`),{__esModule:l,$$typeof:o}=n;n.default;let i=(0,a.createProxy)(String.raw`/home/hirwa/Desktop/PROJECTS/E-garage/frontend/lib/auth.tsx#AuthProvider`);(0,a.createProxy)(String.raw`/home/hirwa/Desktop/PROJECTS/E-garage/frontend/lib/auth.tsx#useAuth`);var d=s(9125);let c={title:"E-Garage",description:"Garage Management"};function x({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{children:(0,r.jsxs)(i,{children:[e,r.jsx(d.x7,{position:"top-right",toastOptions:{style:{background:"#1f2937",color:"white"}}})]})})})}},7272:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[300,434,318,424],()=>s(441));module.exports=r})();